# 1. 회귀계수의 추정
## 1. 단순선형회귀분석
- 독립변수와 종속변수가 1개씩일 때 둘 사이의 인과관계를 분석하는 것으로, 두 변수의 관계가 선형이다.
- 최소제곱법을 활용하여 실제 데이터와 오차가 가장 작아지는 직선의 방정식을 찾는다.

$$
Y = \beta_0+\beta_1 X+\epsilon \\
(\beta_0:회귀계수\,상수항,\,\beta_1:회귀계수\,기울기,\,\epsilon:오차항)
$$

## 2. 최소제곱법으로 회귀계수 추정
- 최소제곱법을 통해 파라미터를 추정하고 추정된 파라미터를 통해 추세선을 그려 값을 예측하는 것이 회귀분석의 기본 알고리즘이다.
- 최고제곱법이란 실제 관측치와 추세선에 의해 예측된 점 사이의 거리, 즉 오차를 제곱해 더한 값을 최소화하는 것이다. 좌표평면상에서 다양한 추세선이 그려질 수는 있지만, 잔차의 제곱 합이 최소가 되는 추세선이 가장 합리적인 추세선이고 이를 통해 회귀분석을 진행한다.
- 회귀계수
  - SST(총제곱합): 전체 설명이 필요
  - SSE(오차제곱합): 모형이 설명하지 못하는 부분
  - SSR(회귀제곱합): 모형이 설명하는 부분

# 2. 회귀분석모형의 적합성
## 1. 회귀분석의 분산분석표
- 회귀분석의 결과에 대한 모형 적합성을 검정하기 위해서는 분산분석표를 사용해야 한다. 독립변수가 1개라면 단순회귀분석, 2개 이상이라면 다중회귀분석을 시행한다.

## 2. 회귀모형의 통계적 유의성 검증
- 회귀모형의 귀무가설은 '모든 회귀계수는 0이다.'이며, F-검정을 통해 확인한다.
- F-검정은 분산의 차이를 확인할 때 사용되는데, 바로 이 분산의 차이가 크다는 것은 회귀모형에서 회귀계수가 크다는 의미를 갖는다.
- F-통계량, 즉 F값이 크다는 말은 회귀계수가 크고 가파르다는 말과 같으니 변수 간에 유의미한 인과관계가 존재한다고 볼 수 있다는 것이다.
- 따라서 F값이 크면, F값이 '0'에서 얼마나 가까운지 확률적으로 측정한 값이 P값은 상대적으로 작아진다. P값은 회귀모형에서 0.05보다 작을 경우 유의미한 인과관계가 있다고 판단하는 중요한 기준이 된다.

## 3. 회귀계수의 통계적 유의성 검증
- 회귀계수의 유의성은 t-검정을 통해 확인할 수 있다. t-통계량은 회귀계수를 표준오차로 나눈 값이다. 따라서 t-통계량이 크다는 것은 분모가 작다는 의미이므로 분모에 해당하는 표준오차가 작다고 볼 수 있다. 반대로 말하면 분자인 회귀계수가 분모보다 크다는 말과 같다.
- t-통계량이 크면 회귀계수도 커지고, 회귀계수가 크므로 유의미한 인과관계가 검증이 되는 것이다. 회귀모형의 통계적 유의성 검증에서 살펴본다면, t-통계량이 크면 회귀계수도 커지고 변수 간에 유의미한 인과관계가 존재하며 P값은 작아진다.

## 4. 모형의 설명력
- 회귀모형의 설명력이 좋다는 의미는 데이터들의 분포가 회귀선에 밀접하게 분포하고 있다는 의미다.
- 회귀분석 결과를 분산분석하고, 도출된 결정계수 $R^2$으로 모형의 설명력을 판단한다.
- 결정계수 $R^2$이 1에 가깝다면 데이터들이 회귀선에 매우 밀접하게 분포한다는 것이며, 이는 곧 회귀 모형의 예측력이 높다는 말과도 같다. 다른 말로 결정계수가 1에 가까울수록 회귀모형이 주어진 자료를 잘 설명한다고 말하기도 한다.
- 결정계수 $R^2$을 구하는 공식은 다음과 같다.

$$
R^2 = \frac{Q-Q_e}{Q}
$$

- 여기서 $Q$는 전체 데이터들의 편차들을 제곱하여 합한 값이며, $Q_e$는 전체 데이터들의 잔차들을 제곱하여 합한 값이다.
- 따라서 이를 다른 공식으로 풀어보면 다음과 같다.

$$
R^2=\frac{회귀모형에\,의해\,설명되는\,변동}{총변동}=\frac{SSR}{SST}=\frac{SST-SSE}{SST}
$$

### 수정된 결정계수
- 결정계수는 SSR/SST로 계산되므로 독립변수의 수가 많아질수록 증가하는 성질이 있다. 즉, 종속변수에 영향을 주지 않은 독립변수가 모형에 포함되어도 결정계수가 커지는 것이다.
- 이런 단점을 보완하기 위해 다중회귀분석에서는 수정된 결정계수라는 개념을 사용한다.

$$
adjusted\,R^2=1-\frac{(n-1)(1-R^2)}{n-p-1} \\
n=표본의\,크기,\,p=독립변수의\,수
$$

- 식을 보면 분모에 p를 위치시켜 독립변수가 증가함에 따라 증가하는 결정계수를 상쇄해준다. 수정된 결정계수는 보통 결정계수보다 작게 계산되는 특징이 있다.
- 단순선형회귀에서는 결정계수를, 다중회귀분석에서는 수정된 결정계수를 보지만, 다항회귀분석은 결정계수와 수정된 결정계수 모두를 참고할 수 있다.
- 하지만 그 차이가 크다면 결정계수가 아닌 AIC, BIC와 같은 벌점이나 다른 지표를 활용해서 모델을 평가해야 한다.

# 3. 단순선형회귀분석의 예
## 1. 자동차 배기량과 연비 회귀분석
- X를 배기량, Y를 그에 따른 연비라고 가정해보자.

```
> X <- c(1, 1.4, 1.6, 2, 2.2, 2.4, 3, 3.3, 3.6)
> Y <- c(15, 13, 13, 12, 11, 10.5, 10, 9, 8)
> result <- lm(Y ~ X)
> summary(result)

Call:
lm(formula = Y ~ X)

Residuals:
     Min       1Q   Median       3Q      Max
-0.47990 -0.41705  0.04524  0.21353  0.60809

Coefficients:
            Estimate Std. Error t value Pr(>|t|)
(Intercept)  16.8291     0.4142   40.63 1.43e-09 ***
X            -2.4371     0.1707  -14.27 1.97e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4277 on 7 degrees of freedom
Multiple R-squared:  0.9668,    Adjusted R-squared:  0.962
F-statistic: 203.7 on 1 and 7 DF,  p-value: 1.97e-06
```

- p-value 값이 1.97e-06으로, 유의수준 0.05에서 회귀분석의 귀무가설을 기각한다.
- 따라서 '모든 회귀계수는 0이다'라고 할 수 없으므로 주어진 모형은 통계적으로 유의하다.
- 모형이 유의하면 각 회귀계수에 대한 p-value를 확인해야 한다. X의 회귀계수 p-value는 1.97e-06으로 독립변수 X에 대한 귀무가설을 기각한다. 따라서 X의 회귀계수는 -2.4371일 것으로 추정 가능하다.
- 상수항의 추정치는 16.8291이다.
- 따라서 추정되는 회귀식은 $Y(연비) = {-2.4371 * X(배기량)} + 16.8291$ 이다.

## 2. 분산분석표와 수정계수

```
> X <- c(1, 1.4, 1.6, 2, 2.2, 2.4, 3, 3.3, 3.6)
> Y <- c(15, 13, 13, 12, 11, 10.5, 10, 9, 8)
> result <- lm(Y ~ X)
> anova(result)
Analysis of Variance Table

Response: Y
          Df Sum Sq Mean Sq F value   Pr(>F)
X          1 37.275  37.275  203.73 1.97e-06 ***
Residuals  7  1.281   0.183
```

$$
R^2=\frac{SSR}{SST}=\frac{SSR}{SSR+SSE}=\frac{37.275}{37.275+1.281}=0.9667755...
$$

### QQ-plot
- QQ plot(Quantile-Qunatile Plot)은 모집단 또는 표본집단의 정규분포를 따르는지 시각적으로 확인하기 위한 산점도다.
- QQ plot의 점들이 45도에 가까운 직선의 모양을 띨수록 정규분포를 따른다고 할 수 있다.